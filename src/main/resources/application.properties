# app name
spring.application.name=QuizMaker
# MySQL connection (CI or local)
spring.datasource.url=jdbc:mysql://localhost:3306/quizmakerdb?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC
spring.datasource.username=bestuser
spring.datasource.password=bestuser
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
# JPA / Hibernate
spring.jpa.database-platform=org.hibernate.dialect.MySQL8Dialect
# Use Hibernate schema management for now; migrations will take over later
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
logging.level.org.springframework=DEBUG
logging.level.uk.gegc.quizmaker=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
spring.jpa.properties.hibernate.format_sql=true
logging.level.org.springframework.orm.jpa=DEBUG
spring.config.import=optional:classpath:secret.properties,optional:file:.env[.properties]
jwt.access-expiration-ms=43200000
jwt.refresh-expiration-ms=604800000
# serve the raw OpenAPI JSON under /api/v1/docs
springdoc.api-docs.path=/api/v1/docs
# serve the Swagger-UI HTML under /api/v1/docs/swagger-ui.html
springdoc.swagger-ui.path=/api/v1/docs/swagger-ui.html
# point the UI itself at your new JSON location
springdoc.swagger-ui.url=/api/v1/docs
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=always
# Document Processing Configuration
document.chunking.max-chunk-size=100000
document.chunking.min-chunk-size=1000
document.chunking.aggressive-combination-threshold=5000
document.chunking.default-strategy=CHAPTER_BASED
# File Upload Configuration
spring.servlet.multipart.max-file-size=150MB
spring.servlet.multipart.max-request-size=150MB
spring.servlet.multipart.enabled=true
# OpenAI Configuration
spring.ai.openai.api-key=${OPENAI_API_KEY}
spring.ai.openai.chat.options.model=${OPENAI_MODEL:gpt-4.1-mini}

# Feature flags (Day-0 default: on in dev, can override in prod)
quizmaker.features.share-links=true
quizmaker.features.organizations=true

# Share Links security
quizmaker.share-links.token-pepper=${TOKEN_PEPPER_SECRET}

# Enable Problem+JSON standardized errors
spring.mvc.problemdetails.enabled=true

# Enable Flyway by default
spring.flyway.enabled=true

# AI Rate Limiting Configuration
ai.rate-limit.max-retries=5
ai.rate-limit.base-delay-ms=1000
ai.rate-limit.max-delay-ms=60000
ai.rate-limit.jitter-factor=0.25

# Async Configuration
# AI Operations Thread Pool
async.ai.core-pool-size=4
async.ai.max-pool-size=8
async.ai.queue-capacity=50
async.ai.keep-alive-seconds=60

# General Operations Thread Pool
async.general.core-pool-size=2
async.general.max-pool-size=4
async.general.queue-capacity=25
async.general.keep-alive-seconds=60

# CORS Configuration
# Allowed origins - Configure based on your frontend URLs
# For production, replace with your actual domain(s)
app.cors.allowed-origins=http://localhost:3000,http://localhost:4200,http://localhost:5173
# For development with dynamic ports (e.g., Vite), set this to true
app.cors.use-origin-patterns=false
# Allowed HTTP methods including HEAD for cache validation
app.cors.allowed-methods=GET,POST,PUT,PATCH,DELETE,OPTIONS,HEAD
# Allowed headers in requests - add more as needed
app.cors.allowed-headers=Authorization,Content-Type,Accept,X-Requested-With,Origin,If-None-Match,Accept-Language
# Headers exposed to the client (response headers the browser can access)
app.cors.exposed-headers=Location,Link,Content-Disposition,X-Total-Count,X-RateLimit-Limit,X-RateLimit-Remaining,X-RateLimit-Reset
# Allow credentials (cookies, authorization headers) - set to false if using only JWT in header
app.cors.allow-credentials=true
# Max age for preflight cache (1 hour)
app.cors.max-age=3600

# Email Configuration (SMTP)
spring.mail.host=${SMTP_HOST:smtp.gmail.com}
spring.mail.port=${SMTP_PORT:587}
spring.mail.username=${SMTP_USERNAME:kidsgpt.test@gmail.com}
spring.mail.password=${SMTP_PASSWORD:bmioayfllgytmnfw}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=${SMTP_USE_TLS:true}
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.connectiontimeout=5000
spring.mail.properties.mail.smtp.timeout=5000
spring.mail.properties.mail.smtp.writetimeout=5000
spring.mail.default-encoding=UTF-8

# Email Application Configuration
app.email.password-reset.subject=Password Reset Request - QuizMaker
app.email.password-reset.base-url=${FRONTEND_BASE_URL:http://localhost:3000}
